<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Weekly Attendance</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Navigation Header -->
    <header class="nav-header">
        <h1>Oppm√∏√∏√∏te</h1>
        <nav>
            <a href="/">Home</a> |
            <a href="/weekly-view">Weekly View</a> |
            <a href="/list-view">List View</a>
        </nav>
    </header>
    
    <!-- Weekly Attendance Grid -->
    <main>
        <h2>Ukens oppsummering</h2>
        <div id="week-grid"></div>
    </main>
    <script>
        async function loadWeekly() {
            const res = await fetch('/weekly');
            const data = await res.json();
            const grid = document.getElementById('week-grid');
            grid.innerHTML = '';

            const todayStr = new Date().toISOString().slice(0,10);

            Object.keys(data).forEach(date => {
                const card = document.createElement('div');
                card.className = 'day-card';

                const d = new Date(date);
                const weekday = d.getDay();

                if(date === todayStr) card.classList.add('today');
                if(weekday === 0 || weekday === 6) card.classList.add('weekend');  // 0 = Sunday, 6 = Saturday

                const title = document.createElement('div');
                title.className = 'day-title';
                // Use Norwegian day name from backend
                title.textContent = `${data[date].day_name} ${d.toLocaleDateString('nb-NO', { day: 'numeric', month: 'short' })}`;
                card.appendChild(title);
                if(date === todayStr) title.classList.add('today');

                data[date].records.forEach((record, index) => {
                    const rec = document.createElement('div');
                    rec.className = 'record';
                    if(record.name === "Unknown") rec.classList.add('unknown');

                    const nameSpan = document.createElement('span');
                    nameSpan.className = 'name';

                    // nameSpan.textContent = record.name;
                    // Ku-emoji til f√∏rste som kom denne dagen
                    if(index === 0) {
                        nameSpan.textContent = `${record.name} üêÆ`;
                    } else {
                        nameSpan.textContent = record.name;
                    }

                    const tagSpan = document.createElement('span');
                    tagSpan.className = 'tag';
                    tagSpan.textContent = ` (${record.tag})`;

                    rec.appendChild(nameSpan);
                    rec.appendChild(tagSpan);
                    card.appendChild(rec);
                });

                grid.appendChild(card);
            });
        }

        setInterval(loadWeekly, 5000); // refresh every 2 seconds
        loadWeekly();
    </script>
</body>
<footer>
    Velkommen til kontoret!
</footer>

</html>
